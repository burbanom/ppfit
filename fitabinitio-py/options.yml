######    Options for Serial version, with mpi executable code    ######
#calculation:
#    code: pimaim
#    exec: ~/bin/pimaim_mpi/pimaim_mpi
#    code_mpi: True
#    mpi_exec: mpiexec.hydra
#    run_configs: serial
#    mpi_np: -np
#    exec_proc: 8
#    mpi_options: -f

#####      Options for pool version, with several instances of mpi executable code (single node)   #######

#calculation:
#    code: pimaim
#    exec: ~/bin/pimaim_mpi/pimaim_mpi
#    code_mpi: True
#    mpi_exec: mpiexec.hydra
#    run_configs: pool
#    mpi_np: -np
#    exec_proc: 2
#    mpi_options: -genv I_MPI_FABRICS=dapl,ofa,tcp,tmi,ofi -f

#####      Options for mpi4py version, with several instances of mpi executable code (multiple nodes)  #######

calculation:
    code: pimaim
    exec: /local/home/mburbano/Dropbox/Work/Source/pimaim/classique/pimaim.exe
    code_mpi: True 
    run_configs: serial #serial, pool or mpi4py
    mpi_exec: mpirun # mpiexec #mpirun executable for serial and pool runs (mpi4py spawn will handle this otherwise)
    mpi_np: -np          # string for number of processes
    exec_proc: 1    # execute each instance of code over exec_proc processes
    mpi_options: -f 
#    no_nodes:  1            # number of nodes
#                             #  ^ mpi options for main call to mpi config run. 
#                             # Restrict processes to run node by node in round robin
#                             # last bit -f gives the flag for the host filei
#    no_cpu_node: 1          # number of cpus per node
#    no_slaves: 0            # number of workers. Total no of mpi proc to request in submission is no_slaves + 1(master)


    
# scaling factors for the forces, dipoles and stresses
scaling:
    forces: 20.00
    dipoles: 10.00
    stresses: 5.0

verbose: True

# Nelder-Mead options
method: Nelder-Mead
tolerance:
    xtol: 0.0001   # Relative error in solution xopt acceptable for convergence
    ftol: 0.0001   # Relative error in fun(xopt) acceptable for convergence
maxfev: 1000      # Maximum number of funtion evaluations to make
maxiter: 1000     # Maximum number of iterations to perform

# CG options
#method: CG
#stepsize: 0.0001  # stepsize to approximate gradient - must be small
#tolerance:
#    gtol: 0.001  # Gradient norm must be less than gtol before successful termination
#    ftol: 0.001
#maxiter: 1     # maximum number of iterations to perform

# L-BFGS-B options
#method: L-BFGS-B
#tolerance:         
#    ftol: 0.001   # convergence tolerance
#    gtol: 0.001   # convergence tolerance
#maxiter:  5       # max number of function evaluations
#stepsize: 0.0005  #jacobian calc stepsize
# ---- BASIN HOPPING -----

use_basin_hopping: True 

# Basin hopping parameters   #
basin_hopping:
    calc_order: 0      # Optimization order: 0 for minimization then BH, 1 for BH then minimization
    niter: 100         # Number of BH iterations
    temperature: 15.0
    timestep: 1.00   # Initial step size for use in BH random displacement. 
                     # Recommended 1.00 since steps are in PARAMS file
    niter_success: 5 # max numb of iterations at a minimum

    #----- Minimiser parameters ( parameters above used in intial step if calc_order=0) -----
    method: Nelder-Mead
    tolerance:
        xtol: 0.0001   # Relative error in solution xopt acceptable for convergence
        ftol: 0.0001   # Relative error in fun(xopt) acceptable for convergence
    maxfev: 1000     # Maximum number of funtion evaluations to make
    maxiter: 1000    # Maximum number of iterations to perform
    verbose: True     # Print convergence messages

    # CG options
#    method: CG
#    stepsize: 0.000000005  # stepsize to approximate gradient - must be small
#    tolerance:
#        gtol: 0.001  # Gradient norm must be less than gtol before successful termination
#    maxiter: 100     # maximum number of iterations to perform
#    verbose: True    # Print convergence messages

    # L-BFGS-B options
#    method: L-BFGS-B
#    stepsize: 0.000000005
#    tolerance:
#        ftol: 0.001   # convergence tolerance
#        gtol: 0.001   # convergence tolerance
#    maxiter:  100     # max number of function evaluations
#    verbose:  True    # Print convergence messages
